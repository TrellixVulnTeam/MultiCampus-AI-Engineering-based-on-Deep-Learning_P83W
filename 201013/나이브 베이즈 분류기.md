# 나이브 베이즈 분류기

미래의 사건을 추정하기 위해 과거의 사건 데이터를 사용 하는 **확률적 학습** 기반 필터기

1. 나이브 베이즈 이해
   훈련데이터를 이용해서 특징 값이 제공하는 증거를 기반으로 결과가 관측될 확률을 계산
   - 스팸 메일 필터링(텍스트 분류)
   - 네트웍 침입/비정상행위 탐지(IDS)
   - 일련의 관찰된 증상에 대한 의학적 질병 진단

   
   
2. 베이지안 분류기
   결과에 대한 전체 확률을 알기 위해 동시에 여러가지 속성에 대한 정보를 고려해야하는 문제에
   베이지안 분류기 사용이 적합하다.

   

3. 용어

   - `베이지안 확률` : 사건(잠재적 결과)에 대한 우도(likelihood)는 여러번의 시행(trials, 사건이 발생될 수 
     있도록 하는 시도)에서 사용할 수 있는 증거를 기반으로 추정한다

     > |    시행     |       사건       |
     > | :---------: | :--------------: |
     > | 동전던지기  |    앞면/뒷면     |
     > | 받은 이메일 | 메일이 정상/스팸 |
     > |  로또 구매  |    당첨/낙첨     |

   - `사건 확률`:관측 데이터에서 사건이 발생한 시행 횟수를 전체 시행 횟수로 나누면 됨.

     > P(비)=0.3, P(스팸)=0.2

   - `사전확률(prior prob)`: 과거의 데이터에서 사건이 발생한 확률

     > 받은 메시지의 내용을 모르는 상태에서, 메시지의 스팸 상태를 가장 잘 예측하는 방법
     >
     > -> 이전에 메시지가 스팸일 확률 P(스팸):20%

   - `우도(likelihood)`: 발생한 사건(판단요소) 중에 특정 단어(관련요소)가 일어날 확률

     > '나이트' 단어가 나타났던 빈도를 관측하기 위해 이전에 받았던 메시지들을
     > 살펴보면서 정보를 얻을 수 있음. 
     >
     > - 이전 스팸 메시지(판단요소)에서 '나이트'단어(관련요소)가 사용된 확률: P(나이트|스팸)을 `우도`라고 함.
     > - '나이트'라는 단어가 어떤 메시지에도 나타날 확률 P(나이트)는 `주변우도`라고 함
     >
     > => 위를 토대로 메시지가 스팸이 될 확률을 측정한 사후 확률(posterior prob)을 계산할 수 있음

   - `사후(posterior)확률` : 새로운 데이터가 특정 사건이 될 확률

     > ex) 메시지가 스팸이 될 확률 측정
     >
     > ```R
     > if 사후확률 >50% then 스팸메일 else 햄메일
     > ```
     >
     > *** 이메일 분류기에 베이즈 이론을 적용을 한 수식 ***
     >
     > P(스팸|나이트) = P(나이트|스팸) * P(스팸) /  P(나이트)
     > 사후확률 =        (우도 * 사전확률)     / 주변우도

   - `결합확률` : 시행에서 상호 배타적이지 않은 여러 개의 사건을 관찰

     > *ex)이메일 메시지 '나이트'가 포함된 결과를 기반으로 두번째 사건을 고려.
     > 	'나이트'라는 단어는 스팸 메시지에서 등장.*
     >
     > - 모든 사건이 독립이라면, 다른 사건을 관측해 어떤 사건을 예측하는 것은 불가능
     > - 종속 사건이 예측 모델링의 기반('나이트'라는 단어가 등장했다면 -> 스팸 이메일로 예측)



# 조건부 확률

![조건부 확률 공식 이미지]()

P(A∩B) = P(B|A) * P(A) = P(A|B) * P(B)

P(A|B) = P(A∩B)/P(B) = P(A)P(B|A)/P(B)

**베이즈 정리 : P(B|A) = P(B)P(A|B)/P(A)**



# 라플라스 추정치

- 우도 계산에 있어 특정 사건의 조건부 확률 항목이 0 이라 전체가 0으로 추정되는 오류를 없애기 위한 방법
- 각 조건부 계산에 있어 분자 부분에 +α 의 바이어스 추가해서 계산



# 모델링 과정

1. 데이터 읽기
2. 문장을 단어별(중복제외)로 정리
3. Train 데이터 : 빈도표 기반 우도표 만들기
4. Test 데이터 : 햄우도와 스팸우도를 구해 더 높은 확률에 따라 분류